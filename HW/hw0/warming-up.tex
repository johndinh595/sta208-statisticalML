\documentclass[twoside, letter]{article}
\setlength{\oddsidemargin}{0.01 in}
\setlength{\evensidemargin}{0.01 in}
\setlength{\topmargin}{-0.6 in}
\setlength{\textwidth}{6.5 in}
\setlength{\textheight}{8.5 in}
\setlength{\headsep}{0.75 in}
\setlength{\parindent}{0 in}
\setlength{\parskip}{0.1 in}

\usepackage{natbib}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{xcolor}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\usepackage{pdfpages}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\usepackage{caption}
\lstset{style=mystyle}
%
% ADD PACKAGES here:
%



\usepackage{amsmath,amsfonts,amssymb,graphicx,mathtools,flexisym}

%
% The following commands set up the lecnum (lecture number)
% counter and make various numbering schemes work relative
% to the lecture number.
%
\newcounter{lecnum}
\renewcommand{\thepage}{\thelecnum-\arabic{page}}
\renewcommand{\thesection}{\thelecnum.\arabic{section}}
\renewcommand{\theequation}{\thelecnum.\arabic{equation}}
\renewcommand{\thefigure}{\thelecnum.\arabic{figure}}
\renewcommand{\thetable}{\thelecnum.\arabic{table}}

%
% The following macro is used to generate the header.
%
\newcommand{\lecture}[4]{
   \pagestyle{myheadings}
   \thispagestyle{plain}
   \newpage
   \setcounter{lecnum}{#1}
   \setcounter{page}{1}
   \noindent
   \begin{center}
   \framebox{
      \vbox{\vspace{2mm}
    \hbox to 6.28in { {\bf STA 208 - Statistical Machine Learning
	\hfill Spring 2022} }
       \vspace{4mm}
       \hbox to 6.28in { {\Large \hfill Warming up: Python exercises \hfill} }
       \vspace{2mm}
       %\hbox to 6.28in { {\it Lecturer: #3 \hfill Scribes: #4} }
       \hbox to 6.28in { {\it Lecturer: #2 \hfill  Due April 6th, 2022} }
      \vspace{2mm}}
   }
   \end{center}
   \markboth{Assignment #1: #2}{Assignment #1: #2}

  % {\bf Note}: {\it LaTeX template courtesy of UC Berkeley EECS dept.}

}
%
% Convention for citations is authors' initials followed by the year.
% For example, to cite a paper by Leighton and Maggs you would type
% \cite{LM89}, and to cite a paper by Strassen you would type \cite{S69}.
% (To avoid bibliography problems, for now we redefine the \cite command.)
% Also commands that create a suitable format for the reference list.
\renewcommand{\cite}[1]{[#1]}
\def\beginrefs{\begin{list}%
        {[\arabic{equation}]}{\usecounter{equation}
         \setlength{\leftmargin}{2.0truecm}\setlength{\labelsep}{0.4truecm}%
         \setlength{\labelwidth}{1.6truecm}}}
\def\endrefs{\end{list}}
\def\bibentry#1{\item[\hbox{[#1]}]}

%Use this command for a figure; it puts a figure in wherever you want it.
%usage: \fig{NUMBER}{SPACE-IN-INCHES}{CAPTION}
\newcommand{\fig}[3]{
			\vspace{#2}
			\begin{center}
			Figure \thelecnum.#1:~#3
			\end{center}
	}
% Use these for theorems, lemmas, proofs, etc.
\newtheorem{theorem}{Theorem}[lecnum]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newenvironment{proof}{{\bf Proof:}}{\hfill\rule{2mm}{2mm}}

% **** IF YOU WANT TO DEFINE ADDITIONAL MACROS FOR YOURSELF, PUT THEM HERE:

\newcommand\E{\mathbb{E}}
\newcommand{\bitm}{\begin{itemize}}
\newcommand{\eitm}{\end{itemize}}
\newcommand{\blst}{\begin{lstlisting}}
\newcommand{\elst}{\end{lstlisting}}
\newcommand{\bfig}{\begin{figure}}
\newcommand{\efig}{\end{figure}}


\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{\thesection.\arabic{subsection}}
\renewcommand{\thesubsubsection}{\thesubsection.\arabic{subsubsection}}

\begin{document}
%FILL IN THE RIGHT INFO.
%\lecture{**LECTURE-NUMBER**}{**DATE**}{**LECTURER**}{**SCRIBE**}
\lecture{0}{Bo Y.-C. Ning}{Bo Y.-C. Ning}{}
%\footnotetext{These notes are partially based on those of Nigel Mansell.}

% **** YOUR NOTES GO HERE:

Due {\bf April 6th, 2022} by 11:59pm. 

Please:
\begin{enumerate}
\item Submit your homework using the file name "{\bf LastName\_FirstName\_hw1.html}"

\item Your code should be readable; writing a piece of code should be compared to writing a page of a book. Adopt the {\bf one-statement-per-line} rule. Consider splitting a lengthy statement into multiple lines to improve readability. (You will lose one point for each line that does not follow the one-statement-per-line rule)

\item To help understand and maintain code, you should always add comments to explain your code. (homework with no comments will receive 0 points). For a very long comment, break it into multiple lines.

\item Submit your final work with one {\bf .html} file to Canvas. 

\item In your $\mathsf{Jupyter \ Notebook}$, put your answers in new cells after each exercise. You can make as many new cells as you like. Use code cells for code and Markdown cells for text. 

\item This assignment will be graded for correctness. 
\end{enumerate}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
1. Basic exercises using $\mathsf{numpy}$: let $u = (1, 2, 3, 3, 2, 1)'$
\begin{itemize}
\item[(a)] Compute $U = I - \frac{2}{u'u} uu'$ (This type of matrix is known as an
`elementary reflector' or a `Householder transformation.')
\item[(b)] Let $C = U U$ (matrix-matrix multiplication), the matrix product of $U$ and itself. Find the largest and smallest off-diagonal elements of $C$.
\item[(c)] Find the largest and smallest diagonal elements of $C$.
\item[(d)] Compute $U u$. (matrix-vector multiplication)
\item[(e)] Compute the scalar $\max_i \sum_j |U_{ij}|$
\item[(f)] Print the third row of $U$.
\item[(g)] Print the elements of the second column below the diagonal.
\item[(h)] Let $A$ be the first three columns of $U$. Compute $P = AA'$.
\item[(i)] Show that $P$ is idempotent by recomputing (e) with $PP-P$.
\item[(j)] Let $B$ be the last three columns of $U$. Compute $Q = BB'$.
\item[(k)] Show that $Q$ is idempotent by recomputing (e) with $QQ-Q$.
\item[(l)] Compute $P + Q$
\end{itemize}

2. Read in the matrix in the file `oringp.dat' (available on Piazza) on the failure of O-rings leading to the Challenger
disaster. The columns are flight number, date, number of O-rings, number failed, and temperature at launch. Compute the correlation between number of failures and temperature at
launch, deleting the last, missing observation (the disaster).

3. Consider the mixed effect model 
$$
y_i = x_i' \beta + z_i' \gamma + \epsilon_i, \quad i = 1, \dots, n,
$$
where $\epsilon_i \sim N(0, \sigma_0^2)$ are independent normal errors, $\beta \in \mathbb{R}^p$ are fixed effects, $\gamma \in \mathbb{R}^q$ are random effects assumed to be $N(0_q, \sigma_1^2 I_q)$, $\gamma$ and $\epsilon_i$ are independent. For simplicity, assume $\mu_i = x_i' \beta$. 
Let $ y = (y_1, \dots, y_n)'$, $ \mu = (\mu_1, \dots, \mu_n)'$, 
$ Z = (z_1, \dots, z_n)'$, 
then
$ y \in \mathbb{R}^{n}$, $ \mu \in \mathbb{R}^n$, $ Z \in \mathbb{R}^{n \times q}$,
and 
$ y \sim N( \mu, \sigma_1^2 ZZ'  + \sigma_0^2 I_n)$.
The log-density function is given by
$$
 -\frac{n}{2} \log(2 \pi) - \frac{1}{2} \log (\det(\sigma_1^2 ZZ' + \sigma_0^2 I_n)) - \frac{1}{2} (y-\mu)'(\sigma_1^2 ZZ' + \sigma_0^2I_n)^{-1} (y-\mu).
$$

Please write a function, call it 
$\mathsf{dmvnorm\_lowrank(y, mu, Z, sigma0, sigma1, log = FALSE)}$
that evaluates the (log)-density function at a given $y \in \mathbb{R}^n$.
Choose values for $n (> 5)$ and $q (> 3)$, test your function on simulated data.

Notes: 
1) When $\mathsf{log = FALSE}$, your function should calculate the log likelihood; when 
$\mathsf{log = TRUE}$, your function should calculate the original likelihood function. 
The default uses $\mathsf{log = FALSE}$. 
2) Use the $\mathsf{np.random.seed}$ function before generating data from a random distribution.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%% Bibliography %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{chicago}
\bibliography{citation.bib}

 \end{document}